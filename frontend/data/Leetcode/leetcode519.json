{
  "ID": "leetcode519",
  "coding_practice": [
    {
      "title": "Random Flip Matrix",
      "description": "There is an m x n binary grid matrix with all the values set 0 initially. Design an algorithm to randomly pick an index (i, j) where matrix[i][j] == 0 and flips it to 1. All the indices (i, j) where matrix[i][j] == 0 should be equally likely to be returned.\n\nOptimize your algorithm to minimize the number of calls made to the built-in random function of your language and optimize the time and space complexity.\n\nImplement the Solution class:\n\nSolution(int m, int n) Initializes the object with the size of the binary matrix m and n.\nint[] flip() Returns a random index [i, j] of the matrix where matrix[i][j] == 0 and flips it to 1.\nvoid reset() Resets all the values of the matrix to be 0.",
      "examples": [
        {
          "input": "[\"Solution\", \"flip\", \"flip\", \"flip\", \"reset\", \"flip\"], [[3, 1], [], [], [], [], []]",
          "output": "[null, [1,0], [2,0], [0,0], null, [2,0]]",
          "explanation": "Solution solution = new Solution(3, 1);\nsolution.flip();  // return [1,0], [0,0], [1,0], and [2,0] should be equally likely to be returned.\nsolution.flip();  // return [2,0], Since [1,0] was returned, [2,0] and [0,0]\nsolution.flip();  // return [0,0], Based on the previously returned indices, only [0,0] can be returned.\nsolution.reset(); // All the values are reset to 0 and can be returned.\nsolution.flip();  // return [2,0], [0,0], [1,0], and [2,0] should be equally likely to be returned."
        }
      ],
      "constraints": "1 <= m, n <= 10^4\nThere will be at least one free cell for each call to flip.\nAt most 1000 calls will be made to flip and reset.",
      "solution": "import random\n\nclass Solution:\n\n    def __init__(self, n_rows, n_cols):\n        self.rows = n_rows\n        self.cols = n_cols\n        self.total = n_rows * n_cols\n        self.flipped = {}\n\n    def flip(self):\n        r = random.randint(0, self.total - 1)\n        x = self.flipped.get(r, r)\n        self.total -= 1\n        self.flipped[r] = self.flipped.get(self.total, self.total)\n        return [x // self.cols, x % self.cols]\n\n    def reset(self):\n        self.total = self.rows * self.cols\n        self.flipped.clear()",
      "explanation": "1. 初始化時記錄矩陣大小 rows、cols，總格子數 total，以及一個字典 flipped 來映射已翻轉的位置。\n2. flip 方法隨機選擇一個索引 r，使用字典映射獲得實際位置 x。\n3. 將 total 減 1，並更新 flipped 對應關係，確保隨機選擇不重複。\n4. 返回 x 對應的二維座標 [x // cols, x % cols]。\n5. reset 方法重置 total 並清空 flipped，使矩陣恢復初始狀態。",
      "tag": "511",
      "difficult": "medium"
    }
  ]
}
