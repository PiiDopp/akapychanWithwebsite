{
  "ID": "leetcode710",
  "coding_practice": [
    {
      "title": "Random Pick with Blacklist",
      "description": "You are given an integer n and an array of unique integers blacklist. Design an algorithm to pick a random integer in the range [0, n - 1] that is not in blacklist. Any integer that is in the mentioned range and not in blacklist should be equally likely to be returned.\\n\\nOptimize your algorithm such that it minimizes the number of calls to the built-in random function of your language.\n\nImplement the Solution class:\n\nSolution(int n, int[] blacklist) Initializes the object with the integer n and the blacklisted integers blacklist.\n\nint pick() Returns a random integer in the range [0, n - 1] and not in blacklist.",
      "examples": [
        {
          "input": "[\"Solution\", \"pick\", \"pick\", \"pick\", \"pick\", \"pick\", \"pick\", \"pick\"]\n[[7, [2, 3, 5]], [], [], [], [], [], [], []]",
          "output": "[null, 0, 4, 1, 6, 1, 0, 4]",
          "explanation": "Solution solution = new Solution(7, [2, 3, 5]);\\nsolution.pick(); // return 0, any integer from [0,1,4,6] equally likely\\nsolution.pick(); // return 4\\nsolution.pick(); // return 1\\nsolution.pick(); // return 6\\nsolution.pick(); // return 1\\nsolution.pick(); // return 0\\nsolution.pick(); // return 4"
        }
      ],
      "constraints": "1 <= n <= 10^9\\n0 <= blacklist.length <= min(10^5, n - 1)\\n0 <= blacklist[i] < n\\nAll the values of blacklist are unique.\\nAt most 2 * 10^4 calls will be made to pick.",
      "solution": "import random\n\nclass Solution:\n    def __init__(self, n, blacklist):\n        self.mapping = {}\n        self.size = n - len(blacklist)\n        black = set(blacklist)\n        last = n - 1\n        for b in blacklist:\n            if b < self.size:\n                while last in black:\n                    last -= 1\n                self.mapping[b] = last\n                last -= 1\n\n    def pick(self):\n        index = random.randint(0, self.size - 1)\n        return self.mapping.get(index, index)",
      "explanation": "1. 計算可選範圍大小 size = n - len(blacklist)。\\n2. 將 blacklist 中小於 size 的數字映射到大於等於 size 的非黑名單數字。\\n3. pick: 隨機生成一個 [0, size-1] 的數字，若在映射中則返回映射值，否則返回原數字。\\n4. 保證所有合法數字等概率選擇，減少 random 調用。",
      "tag": "1022",
      "difficult": "hard"
    }
  ]
}
